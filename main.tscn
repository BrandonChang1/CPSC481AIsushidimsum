[gd_scene load_steps=7 format=3 uid="uid://unrxlwdu170"]

[ext_resource type="Texture2D" uid="uid://cbw7j851kawpy" path="res://images/smallsesame.png" id="1_tg8bt"]
[ext_resource type="Texture2D" uid="uid://d2g585c1du0r4" path="res://images/smallsesame_sq.png" id="2_hj5bs"]
[ext_resource type="Texture2D" uid="uid://8n1ck68t34y6" path="res://images/largesesame_sq.png" id="3_wolko"]
[ext_resource type="Texture2D" uid="uid://b05veub2utk4p" path="res://images/chive_sq.png" id="4_wy32f"]

[sub_resource type="GDScript" id="GDScript_pa3jy"]
script/source = "#the menubuttons should show choices left to right, or in a grid, but whatever
#make a large dining table for the background
extends Control

enum {
	small_sesame,
	large_sesame,
	chive,
	egg,
	shrimp,
	turnip,
	shumai,
	steamed,
	chopsticks
}

enum {
	player1,
	player2,
	#player3,
	#player4,
	#player5,
	#player6
}

const num_players = 2
var curr_turn = 0
var items: Array[Array] = []

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	for n in num_players:
		items.append([0,0,0,0,0,0,0,0,0]) # watch out this is a shallow copy. see the abandoned mahjong for more on this.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	pass

func _on_menu_button_food_taken(bowl: int, taken: int, revealed: int) -> void:
	items[curr_turn][taken] += 1
	print_status()

func print_status() -> void:
	print(items)

func inc_turn() -> void:
	curr_turn += 1
	if curr_turn == num_players:
		curr_turn = 0
"

[sub_resource type="GDScript" id="GDScript_1dx7h"]
script/source = "extends MenuButton

const bowl_index = 0
var current_item = 0

# should these be exports in the main scene instead?
var smallsesame_image = preload(\"res://images/smallsesame.png\")
var largesesame_image = preload(\"res://images/largesesame.png\")
var chive_image = preload(\"res://images/chive.png\")

signal food_taken(bowl:int,taken:int,revealed:int)

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	self.get_popup().id_pressed.connect(_on_item_menu_pressed)


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	pass

func _on_item_menu_pressed(id: int):
	print(\"Bowl \", bowl_index, \" was \", current_item , \" now \", id)
	food_taken.emit(bowl_index,current_item,id)
	current_item = id
	match id:
		0:
			set_button_icon(smallsesame_image)
		1:
			set_button_icon(largesesame_image)
		2:
			set_button_icon(chive_image)
"

[node name="Control" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_pa3jy")
metadata/_edit_lock_ = true

[node name="MenuButton" type="MenuButton" parent="."]
layout_mode = 0
offset_left = 772.0
offset_top = 258.0
offset_right = 920.0
offset_bottom = 405.0
theme_override_icons/icon = ExtResource("1_tg8bt")
expand_icon = true
switch_on_hover = true
item_count = 3
popup/item_0/icon = ExtResource("2_hj5bs")
popup/item_1/icon = ExtResource("3_wolko")
popup/item_1/id = 1
popup/item_2/icon = ExtResource("4_wy32f")
popup/item_2/id = 2
script = SubResource("GDScript_1dx7h")
popup/item_1/icon = ExtResource("3_wolko")
popup/item_0/icon = ExtResource("2_hj5bs")
popup/item_2/icon = ExtResource("4_wy32f")
metadata/bowl_index = 0
metadata/current_item = 0

[node name="MaxSmallSesameCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 364.0
offset_top = 283.0
offset_right = 457.0
offset_bottom = 341.0

[node name="MaxLargeSesameCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 350.0
offset_top = 590.0
offset_right = 390.0
offset_bottom = 613.0

[node name="MaxChiveCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 364.0
offset_top = 364.0
offset_right = 404.0
offset_bottom = 387.0

[connection signal="food_taken" from="MenuButton" to="." method="_on_menu_button_food_taken"]
