[gd_scene load_steps=12 format=3 uid="uid://unrxlwdu170"]

[ext_resource type="Texture2D" uid="uid://cbw7j851kawpy" path="res://images/smallsesame.png" id="1_tg8bt"]
[ext_resource type="Texture2D" uid="uid://d2g585c1du0r4" path="res://images/smallsesame_sq.png" id="2_hj5bs"]
[ext_resource type="Texture2D" uid="uid://8n1ck68t34y6" path="res://images/largesesame_sq.png" id="3_wolko"]
[ext_resource type="Texture2D" uid="uid://bng3mt3l5nejh" path="res://images/egg_sq.png" id="4_fhocb"]
[ext_resource type="Texture2D" uid="uid://b05veub2utk4p" path="res://images/chive_sq.png" id="4_wy32f"]
[ext_resource type="Texture2D" uid="uid://b4cxs8g8pg4f0" path="res://images/shrimp_sq.png" id="5_82ukx"]
[ext_resource type="Texture2D" uid="uid://csckvcl4ludgf" path="res://images/turnip_sq.png" id="6_l42ue"]
[ext_resource type="Texture2D" uid="uid://evusbtpc7po4" path="res://images/shumai_sq.png" id="7_q68mw"]
[ext_resource type="Texture2D" uid="uid://bvevxkj6ufquj" path="res://images/steamed_sq.png" id="8_k300g"]

[sub_resource type="GDScript" id="GDScript_pa3jy"]
script/source = "#the menubuttons should show choices left to right, or in a grid, but whatever
#make a large dining table for the background
# for opponents, do simple label counter, for yourself do stacked icons
extends Control

enum {
	small_sesame,
	large_sesame,
	chive,
	egg,
	shrimp,
	turnip,
	shumai,
	steamed
}

enum {
	player1,
	player2,
	#player3,
	#player4,
	#player5,
	#player6
}

const num_players = 2
var curr_turn = 0
var player_foods: Array[Array] = []

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	for n in num_players:
		player_foods.append([0,0,0,0,0,0,0,0]) # watch out, this is a shallow copy. see the abandoned mahjong for more on this.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	pass

func _on_menu_button_food_taken(bowl: int, taken: int, revealed: int) -> void:
	player_foods[curr_turn][taken] += 1
	# make new function that does the following: increment the appropriate item, updates the counter. counter needs to be in lockstep with the array variable. and also calculate poitn value.
	print_status()

func counter_update() -> void:
	pass

func print_status() -> void:
	print(player_foods)

func inc_turn() -> void:
	curr_turn += 1
	if curr_turn == num_players:
		curr_turn = 0
"

[sub_resource type="GDScript" id="GDScript_1dx7h"]
script/source = "extends MenuButton

const bowl_index = 0
var current_item = 0

# should these be exports in the main scene instead?
var smallsesame_image = preload(\"res://images/smallsesame.png\")
var largesesame_image = preload(\"res://images/largesesame.png\")
var chive_image = preload(\"res://images/chive.png\")
var egg_image = preload(\"res://images/egg.png\")
var shrimp_image = preload(\"res://images/shrimp.png\")
var turnip_image = preload(\"res://images/turnip.png\")
var shumai_image = preload(\"res://images/shumai.png\")
var steamed_image = preload(\"res://images/steamed.png\")


signal food_taken(bowl:int,taken:int,revealed:int)

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	self.get_popup().id_pressed.connect(_on_item_menu_pressed)


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	pass

func _on_item_menu_pressed(id: int):
	print(\"Bowl \", bowl_index, \" was \", current_item , \" now \", id)
	food_taken.emit(bowl_index,current_item,id)
	current_item = id
	match id:
		0:
			set_button_icon(smallsesame_image)
		1:
			set_button_icon(largesesame_image)
		2:
			set_button_icon(chive_image)
		3:
			set_button_icon(egg_image)
		4:
			set_button_icon(shrimp_image)
		5:
			set_button_icon(turnip_image)
		6:
			set_button_icon(shumai_image)
		7:
			set_button_icon(steamed_image)
"

[node name="Control" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_pa3jy")
metadata/_edit_lock_ = true

[node name="MenuButton" type="MenuButton" parent="."]
layout_mode = 0
offset_left = 772.0
offset_top = 258.0
offset_right = 920.0
offset_bottom = 405.0
theme_override_icons/icon = ExtResource("1_tg8bt")
expand_icon = true
switch_on_hover = true
item_count = 8
popup/item_0/text = "Small Sesame Ball"
popup/item_0/icon = ExtResource("2_hj5bs")
popup/item_1/text = "Large Sesame Ball"
popup/item_1/icon = ExtResource("3_wolko")
popup/item_1/id = 1
popup/item_2/text = "Chive Dumpling"
popup/item_2/icon = ExtResource("4_wy32f")
popup/item_2/id = 2
popup/item_3/text = "Egg Tart"
popup/item_3/icon = ExtResource("4_fhocb")
popup/item_3/id = 3
popup/item_4/text = "Shrimp Dumpling"
popup/item_4/icon = ExtResource("5_82ukx")
popup/item_4/id = 4
popup/item_5/text = "Turnip Cake"
popup/item_5/icon = ExtResource("6_l42ue")
popup/item_5/id = 5
popup/item_6/text = "Shumai Dumpling"
popup/item_6/icon = ExtResource("7_q68mw")
popup/item_6/id = 6
popup/item_7/text = "Steamed Bun"
popup/item_7/icon = ExtResource("8_k300g")
popup/item_7/id = 7
script = SubResource("GDScript_1dx7h")
metadata/bowl_index = 0
metadata/current_item = 0

[node name="MaxSmallSesameCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 364.0
offset_top = 283.0
offset_right = 457.0
offset_bottom = 341.0

[node name="MaxLargeSesameCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 350.0
offset_top = 590.0
offset_right = 390.0
offset_bottom = 613.0

[node name="MaxChiveCounter" type="Label" parent="."]
layout_mode = 0
offset_left = 364.0
offset_top = 364.0
offset_right = 404.0
offset_bottom = 387.0

[connection signal="food_taken" from="MenuButton" to="." method="_on_menu_button_food_taken"]
